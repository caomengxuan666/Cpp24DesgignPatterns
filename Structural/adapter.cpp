// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
// â”ƒ  MODULE   ::  Adapter Pattern                                               â”ƒ
// â”ƒ  PURPOSE   ::  Convert interface of a class to another interface clients expect â”ƒ
// â”ƒ  CATEGORY  ::  Structural Pattern                                           â”ƒ
// â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

/**
 * @file    adapter.cpp
 * @brief   ç°ä»£ C++20 å®ç°é€‚é…å™¨æ¨¡å¼
 * @details 
 *          é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·ç«¯æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£ã€‚
 *          å®ƒä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„ç±»å¯ä»¥ååŒå·¥ä½œï¼Œå°±åƒç”µæºæ’å¤´è½¬æ¢å™¨ä¸€æ ·ã€‚
 * 
 * @par æ ¸å¿ƒæ€æƒ³
 *      - **å¯¹è±¡é€‚é…å™¨**ï¼šé€šè¿‡ç»„åˆï¼ˆhas-aï¼‰åŒ…è£…æ—§æ¥å£
 *      - **ç±»é€‚é…å™¨**ï¼šé€šè¿‡å¤šé‡ç»§æ‰¿ï¼ˆis-aï¼‰å®ç°ï¼ˆC++ ä¸­ä¸æ¨èï¼‰
 *      - å®¢æˆ·ç«¯åªä¾èµ–ç›®æ ‡æ¥å£ï¼Œä¸å…³å¿ƒé€‚é…ç»†èŠ‚
 * 
 * @note    æœ¬å®ç°ä½¿ç”¨å¯¹è±¡é€‚é…å™¨ + æ™ºèƒ½æŒ‡é’ˆï¼Œé¿å…å†…å­˜æ³„æ¼
 * @warning é¿å…ä½¿ç”¨ç±»é€‚é…å™¨ï¼ˆå¤šç»§æ‰¿æ˜“å‡ºé—®é¢˜ï¼‰
 * @todo    æ”¯æŒè¿è¡Œæ—¶æ’ä»¶å¼é€‚é…å™¨æ³¨å†Œ
 * @date    2025-08-19
 * @version 1.0
 */

#include <memory>
#include <print>

using std::println;

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç›®æ ‡æ¥å£ï¼šä¸¤å­”æ’åº§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/**
 * @brief ç›®æ ‡æ¥å£ï¼šå®¢æˆ·ç«¯æœŸæœ›çš„æ¥å£ï¼ˆä¸¤å­”æ’åº§ï¼‰
 */
class TwoPinOutlet {
public:
    virtual ~TwoPinOutlet() = default;

    /**
     * @brief å¼€å§‹å……ç”µï¼ˆä¸¤å­”ï¼‰
     */
    virtual void chargeWithTwoPins() const = 0;
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¢«é€‚é…è€…ï¼šä¸‰å­”æ’åº§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/**
 * @brief è¢«é€‚é…çš„ç±»ï¼šä¸‰å­”æ’åº§ï¼ˆå·²æœ‰ç³»ç»Ÿï¼‰
 */
class ThreePinOutlet {
public:
    void chargeWithThreePins() const {
        println("ğŸ”Œ å¼€å§‹ä¸‰å­”æ’åº§å……ç”µï¼ˆ220Vï¼‰");
    }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¯¹è±¡é€‚é…å™¨ï¼ˆæ¨èï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/**
 * @brief ä¸¤è½¬ä¸‰æ’å¤´é€‚é…å™¨ï¼ˆå¯¹è±¡é€‚é…å™¨ï¼‰
 * @note æˆ‘ä»¬è¿™é‡Œé€šè¿‡ç»§æ‰¿ç›®æ ‡é€‚é…å™¨ç±»ï¼ŒåŒ…å«è¢«é€‚é…çš„ç±»ï¼Œå¹¶å®ç°é€‚é…å™¨ç±»çš„åŠŸèƒ½
 * @details ä½¿ç”¨ç»„åˆï¼ˆhas-aï¼‰åŒ…è£… ThreePinOutlet
 */
class TwoToThreePinAdapter : public TwoPinOutlet {
private:
    std::unique_ptr<ThreePinOutlet> outlet;

public:
    /**
     * @brief æ„é€ å‡½æ•°
     * @param out ä¸‰å­”æ’åº§å¯¹è±¡ï¼ˆè½¬ç§»æ‰€æœ‰æƒï¼‰
     */
    explicit TwoToThreePinAdapter(std::unique_ptr<ThreePinOutlet> out)
        : outlet(std::move(out)) {}

    void chargeWithTwoPins() const override {
        println("ğŸ”„ é€‚é…å™¨ï¼šå°†ä¸¤å­”ä¿¡å·è½¬æ¢ä¸ºä¸‰å­”");
        outlet->chargeWithThreePins();
    }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç±»é€‚é…å™¨ï¼ˆä¸æ¨èï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/**
 * @brief ç±»é€‚é…å™¨ï¼šå¤šé‡ç»§æ‰¿ï¼ˆC++ ä¸­ä¸æ¨èï¼‰
 * @warning å¤šé‡ç»§æ‰¿å¯èƒ½å¯¼è‡´äºŒä¹‰æ€§ã€è±å½¢ç»§æ‰¿ç­‰é—®é¢˜
 */
class ClassAdapter : public TwoPinOutlet, private ThreePinOutlet {
public:
    void chargeWithTwoPins() const override {
        println("ğŸ”„ ç±»é€‚é…å™¨ï¼šå°†ä¸¤å­”è½¬æ¢ä¸ºä¸‰å­”");
        ThreePinOutlet::chargeWithThreePins();
    }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ›´å¤æ‚çš„é€‚é…ï¼šå›½æ ‡è½¬æ¢ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/**
 * @brief ç¾æ ‡æ’åº§ï¼ˆ110Vï¼‰
 */
class USOutlet {
public:
    void charge110V() const {
        println("âš¡ ç¾æ ‡æ’åº§å……ç”µï¼ˆ110Vï¼‰");
    }
};

/**
 * @brief å›½é™…æ—…è¡Œé€‚é…å™¨ï¼šå°†å›½æ ‡è½¬ä¸ºç¾æ ‡
 * @note è¿™é‡Œè¿˜æ˜¯ä¸€æ ·ï¼Œæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªç¾æ ‡æ’åº§ï¼Œç„¶åé€šè¿‡é€‚é…å™¨å°†å›½æ ‡æ’åº§è½¬ä¸ºç¾æ ‡æ’åº§
 */
class TravelAdapter : public TwoPinOutlet {
private:
    std::unique_ptr<USOutlet> usOutlet;

public:
    explicit TravelAdapter(std::unique_ptr<USOutlet> outlet)
        : usOutlet(std::move(outlet)) {}

    void chargeWithTwoPins() const override {
        println("ğŸŒ æ—…è¡Œé€‚é…å™¨ï¼šä¸­å›½220V â†’ ç¾å›½110V è½¬æ¢");
        usOutlet->charge110V();
    }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æµ‹è¯•å‡½æ•° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/**
 * @brief ä½¿ç”¨ä¸¤å­”æ¥å£å……ç”µ
 * @param outlet é€‚é…å™¨æˆ–å…·ä½“å®ç°
 */
void charge(TwoPinOutlet &outlet) {
    outlet.chargeWithTwoPins();
}

/**
 * @brief æµ‹è¯•å¯¹è±¡é€‚é…å™¨
 */
void testObjectAdapter() {
    println("\nğŸ§ª æµ‹è¯• 1: å¯¹è±¡é€‚é…å™¨ï¼ˆæ¨èï¼‰");

    auto threePin = std::make_unique<ThreePinOutlet>();
    auto adapter = std::make_unique<TwoToThreePinAdapter>(std::move(threePin));

    charge(*adapter);
}

/**
 * @brief æµ‹è¯•ç±»é€‚é…å™¨ï¼ˆä¸æ¨èï¼‰
 */
void testClassAdapter() {
    println("\nğŸ§ª æµ‹è¯• 2: ç±»é€‚é…å™¨ï¼ˆä¸æ¨èï¼Œæ…ç”¨ï¼‰");

    ClassAdapter adapter;
    charge(adapter);
}

/**
 * @brief æµ‹è¯•æ—…è¡Œé€‚é…å™¨ï¼ˆçœŸå®åœºæ™¯ï¼‰
 */
void testTravelAdapter() {
    println("\nğŸ§ª æµ‹è¯• 3: å›½é™…æ—…è¡Œé€‚é…å™¨");

    auto usOutlet = std::make_unique<USOutlet>();
    auto adapter = std::make_unique<TravelAdapter>(std::move(usOutlet));

    charge(*adapter);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä¸»å‡½æ•° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/**
 * @brief ä¸»å‡½æ•°
 * @return int
 */
int main() {
    println("ğŸ¯ å¼€å§‹æµ‹è¯•ç°ä»£ C++20 é€‚é…å™¨æ¨¡å¼");

    testObjectAdapter();
    testClassAdapter();
    testTravelAdapter();

    println("\nâœ… æ‰€æœ‰æµ‹è¯•å®Œæˆï¼");
    return 0;
}